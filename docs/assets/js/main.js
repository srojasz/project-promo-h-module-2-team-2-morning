"use strict";const palette1=document.querySelector("#palette1"),palette2=document.querySelector("#palette2"),palette3=document.querySelector("#palette3"),cardContainer=document.querySelector(".js-card-container");function changeColorToPalette(){cardContainer.classList.remove("palette1"),cardContainer.classList.remove("palette2"),cardContainer.classList.remove("palette3");const e=document.querySelector(".palette-container__input:checked").value;cardContainer.classList.add("palette"+e)}function setDefaultPalette(){const e=document.querySelector("#palette1");e.checked=!0,e.click()}palette1.addEventListener("click",changeColorToPalette),palette2.addEventListener("click",changeColorToPalette),palette3.addEventListener("click",changeColorToPalette);const formInputName=document.querySelector(".js-name"),formInputRole=document.querySelector(".js-role"),cardName=document.querySelector(".card__name"),cardRole=document.querySelector(".card__role"),data=JSON.parse(localStorage.getItem("data")),defaultName="Nombre Apellido",defaultRole="Front-end developer",isEmpty="",icons=document.querySelector(".js-card__icon");function changeTextItem(e,t,n){e.value===isEmpty?t.innerHTML=n:t.innerHTML=e.value}function updateData(){changeTextItem(formInputName,cardName,defaultName),changeTextItem(formInputRole,cardRole,defaultRole),updateIcons(),changeColorToPalette(),previewImage(),setData()}formInputName.addEventListener("keyup",updateData),formInputRole.addEventListener("keyup",updateData),changeTextItem(formInputName,cardName,defaultName),changeTextItem(formInputRole,cardRole,defaultRole);const form=document.querySelector(".form"),shareButton=document.querySelector(".button"),checkForm=function(){!0===form.checkValidity()?shareButton.classList.add("js-button-active"):shareButton.classList.remove("js-button-active")};form.addEventListener("keyup",checkForm);const shareContainer=document.querySelector(".share__twitter"),twitter=function(e){e.preventDefault(),!0===form.checkValidity()&&shareContainer.classList.remove("hiddenButton")};shareButton.addEventListener("click",twitter);const fr=new FileReader,uploadBtn=document.querySelector(".js__profile-trigger"),fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",setImage),fr.readAsDataURL(t)}let picture="";function setImage(){picture=fr.result,previewImage()}function previewImage(){""!==picture&&(profileImage.style.backgroundImage=`url(${picture})`,profilePreview.style.backgroundImage=`url(${picture})`)}function fakeFileClick(e){e.preventDefault(),fileField.click()}uploadBtn.addEventListener("click",fakeFileClick),fileField.addEventListener("change",getImage);const triggers=document.querySelectorAll(".js-trigger"),openCollapsable=function(e){const t=e.currentTarget.parentElement,n=t.classList.contains("hidden");for(const e of triggers)e.parentElement.classList.add("hidden");n?t.classList.remove("hidden"):t.classList.add("hidden")};for(const e of triggers)e.addEventListener("click",openCollapsable);const iconsData=[{inputElementSelector:".js-email",cardElementSelector:".js-card__icon--email",prefix:"mailto:"},{inputElementSelector:".js-phone",cardElementSelector:".js-card__icon--phone",prefix:"tel:"},{inputElementSelector:".js-linkedin",cardElementSelector:".js-card__icon--linkedin",prefix:"https://www.linkedin.com/in/"},{inputElementSelector:".js-github",cardElementSelector:".js-card__icon--github",prefix:"https://www.github.com/"}],preventIcons=function(e){e.preventDefault()},updateIcons=function(){for(const e of iconsData){const t=document.querySelector(e.inputElementSelector),n=document.querySelector(e.cardElementSelector);t.value===isEmpty?(n.classList.add("js-icon-deactivated"),n.addEventListener("click",preventIcons)):(n.removeEventListener("click",preventIcons),n.classList.remove("js-icon-deactivated"),n.href=e.prefix+t.value)}};updateIcons();for(const e of iconsData){document.querySelector(e.inputElementSelector).addEventListener("keyup",updateData)}const formInputs=document.querySelectorAll(".js-form__input"),palettesData=document.querySelectorAll(".palette-container");function getDataObj(){const e=document.querySelector(".palette-container__input:checked").value,t={palette:parseInt(e),photo:picture};for(const e of formInputs){t[e.name]=e.value}return t}function setData(){const e=getDataObj();localStorage.setItem("data",JSON.stringify(e))}form.addEventListener("change",setData);const getLsData=function(){let e=JSON.parse(localStorage.getItem("data"));if(null!==e){document.querySelector("#palette"+e.palette).checked=!0,picture=e.photo;for(const t of formInputs){const n=t.name;t.value=e[n]}}},resetButton=document.querySelector(".js-card-reset");function reset(){setDefaultPalette();const e=document.querySelectorAll(".js-form__input");for(const t of e)t.value="";picture="./assets/images/fotodefault.png",updateData()}resetButton.addEventListener("click",reset);const responseURL=document.querySelector(".js-response");function sendData(){var e=getJSONFromInputs(Array.from(form.elements));e.skills=["JavaScript","React"],fr&&fr.result?e.photo=fr.result:data&&data.photo&&(e.photo=data.photo),sendRequest(e)}function getJSONFromInputs(e){return e.reduce(function(e,t){return"BUTTON"!==t.nodeName&&("palette"===t.name?t.checked&&(e[t.name]=t.value):e[t.name]=t.value),e},{})}function sendRequest(e){fetch("https://us-central1-awesome-cards-cf6f0.cloudfunctions.net/card/",{method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}).then(function(e){return e.json()}).then(function(e){showURL(e)}).catch(function(e){console.log(e)})}function showURL(e){e.success?responseURL.innerHTML="<a href="+e.cardURL+">"+e.cardURL+"</a>":responseURL.innerHTML="ERROR:"+e.error}shareButton.addEventListener("click",sendData),getLsData(),updateData();